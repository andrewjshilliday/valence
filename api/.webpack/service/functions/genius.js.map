{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./functions/genius.ts","webpack:///external \"axios\"","webpack:///external \"source-map-support/register\""],"names":[],"mappings":"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","file":"functions/genius.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./functions/genius.ts\");\n","import { APIGatewayProxyHandler, APIGatewayProxyResult } from 'aws-lambda';\r\nimport axios from 'axios';\r\nimport 'source-map-support/register';\r\n\r\nconst API_ROOT = \"https://api.genius.com\";\r\nconst PUBLIC_API_ROOT = \"https://genius.com/api\";\r\nconst ACCESS_TOKEN = process.env.GENIUS_ACCESS_TOKEN;\r\n\r\nexport const song: APIGatewayProxyHandler = async (event, _context): Promise<APIGatewayProxyResult> => {\r\n  const artist = event.queryStringParameters[\"artist\"];\r\n  const song = event.queryStringParameters[\"song\"];\r\n  const includeLyrics = (event.queryStringParameters[\"includeLyrics\"] == 'true');\r\n\r\n\tconst response = await getSong(artist, song, includeLyrics);\r\n\r\n\tif (response) {\r\n\t\treturn sendRes(200, JSON.stringify({ song: response }));\r\n\t}\r\n\r\n\treturn sendRes(404, JSON.stringify({ error: 'Requested song not found' }));\r\n}\r\n\r\nconst sendRes = (status: number, body: string): APIGatewayProxyResult => {\r\n  return {\r\n    statusCode: status,\r\n    headers: { 'Access-Control-Allow-Origin': '*' },\r\n    body: body\r\n  };\r\n}\r\n\r\nconst getSong = async (artistName: string, songName: string, includeLyrics: boolean): Promise<Genius.Song> => {\r\n\tconst songHit = await search(artistName, songName);\r\n\r\n\tif (!songHit) { return null; }\r\n\r\n\tconst song = await getSongDetail(songHit.result.id);\r\n\r\n\tif (includeLyrics) {\r\n\t\tsong.lyrics = await retrieveLyrics(song.id, song.writer_artists);\r\n\t}\r\n\r\n\treturn song;\r\n}\r\n\r\nconst search = async (artistName: string, songName: string): Promise<Genius.Hit> => {\r\n  const url = `${API_ROOT}/search?access_token=${ACCESS_TOKEN}&q=${artistName + ' ' + songName}`;\r\n  let response: Genius.GeniusResponse;\r\n\r\n  await axios(url)\r\n    .then(res => {\r\n      response = res.data;\r\n    })\r\n    .catch(console.error);\r\n\r\n  const songHit = findSongHit(response.response.hits, artistName, songName);\r\n\r\n  return songHit;\r\n}\r\n\r\nconst getSongDetail = async (id: number): Promise<Genius.Song> => {\r\n\tconst url = `${API_ROOT}/songs/${id}?access_token=${ACCESS_TOKEN}`;\r\n\tlet response: Genius.GeniusResponse;\r\n\r\n\tawait axios(url)\r\n\t\t.then(res => {\r\n\t\t\tresponse = res.data;\r\n\t\t})\r\n\t\t.catch(console.error);\r\n\t\r\n\treturn response.response.song;\r\n}\r\n\r\nconst findSongHit = (hits: Genius.Hit[], searchArtist: string, searchSong: string): Genius.Hit => {\r\n\tsearchArtist = searchArtist.toLowerCase();\r\n\tsearchSong = searchSong.toLowerCase();\r\n\tlet hitArtist: string\r\n  let hitSong: string;\r\n\r\n  for (let hit of hits) {\r\n\t\thitArtist = (hit.result as Genius.Song).primary_artist.name.toLowerCase();\r\n\t\thitSong = (hit.result as Genius.Song).title.toLowerCase();\r\n\r\n\t\tif (hitArtist.includes(searchArtist) && hitSong.includes(searchSong)) {\r\n\t\t\treturn hit;\r\n\t\t}\r\n\r\n\t\tif (searchArtist.includes('&')) {\r\n\t\t\tif (matchCollabArtists(hitArtist, searchArtist) && hitSong.includes(searchSong)) {\r\n\t\t\t\treturn hit;\r\n\t\t\t}\r\n\t\t}\r\n  }\r\n\r\n\tfor (let hit of hits) {\r\n\t\thitArtist = (hit.result as Genius.Song).primary_artist.name.toLowerCase();\r\n\t\thitSong = (hit.result as Genius.Song).title.toLowerCase();\r\n\r\n\t\tconst regExp = new RegExp('\\((.+?)\\)|\\[(.+?)\\]|{(.+?)}');\r\n\t\tconst hitArtistNoParentheses = hitArtist.replace(regExp, '').trim();\r\n\t\tconst searchArtistNoParentheses = searchArtist.replace(regExp, '').trim();\r\n\t\tconst hitSongNoParentheses = hitSong.replace(regExp, '').trim();\r\n\t\tconst songNoParentheses = searchSong.replace(regExp, '').trim();\r\n\r\n\t\tif (hitArtistNoParentheses.includes(searchArtistNoParentheses) && hitSongNoParentheses.includes(songNoParentheses)) {\r\n\t\t\treturn hit;\r\n\t\t}\r\n\r\n\t\tif (searchArtist.includes('&')) {\r\n\t\t\tif (matchCollabArtists(hitArtistNoParentheses, searchArtistNoParentheses) && hitSongNoParentheses.includes(songNoParentheses)) {\r\n\t\t\t\treturn hit;\r\n\t\t\t}\r\n\t\t}\r\n  };\r\n\r\n\tfor (let hit of hits) {\r\n\t\thitArtist = (hit.result as Genius.Song).primary_artist.name.toLowerCase();\r\n\t\thitSong = (hit.result as Genius.Song).title.toLowerCase();\r\n\r\n\t\tlet regExp = new RegExp(`\\((.+?)\\)|\\[(.+?)\\]|{(.+?)}`);\r\n\t\tconst hitArtistNoParentheses = hitArtist.replace(regExp, '').trim();\r\n\t\tconst searchArtistNoParentheses = searchArtist.replace(regExp, '').trim();\r\n\t\tconst hitSongNoParentheses = hitSong.replace(regExp, '').trim();\r\n\t\tconst searchSongNoParentheses = searchSong.replace(regExp, '').trim();\r\n\r\n\t\tregExp = new RegExp(`[^a-z0-9]+`);\r\n\t\tconst hitArtistAlphanumeric = hitArtistNoParentheses.replace(regExp, '').trim();\r\n\t\tconst searchArtistAlphanumeric = searchArtistNoParentheses.replace(regExp, '').trim();\r\n\t\tconst hitSongAlphanumeric = hitSongNoParentheses.replace(regExp, '').trim();\r\n\t\tconst searchSongAlphanumeric = searchSongNoParentheses.replace(regExp, '').trim();\r\n\r\n\t\tif (hitArtistAlphanumeric.includes(searchArtistAlphanumeric) && hitSongAlphanumeric.includes(searchSongAlphanumeric)) {\r\n\t\t\treturn hit;\r\n\t\t}\r\n\r\n\t\tif (searchArtist.includes('&')) {\r\n\t\t\tif (matchCollabArtists(hitArtistAlphanumeric, searchArtistAlphanumeric) && hitSongAlphanumeric.includes(searchSongAlphanumeric)) {\r\n\t\t\t\treturn hit;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn null;\r\n}\r\n\r\nconst matchCollabArtists = (hitArtist: string, artists: string): boolean => {\r\n\tconst collabArtists = artists.split('&');\r\n\tlet foundMatch: boolean;\r\n\r\n\tcollabArtists.forEach((collabArtist: string) => {\r\n\t\tcollabArtist = collabArtist.trim();\r\n\r\n\t\tif (hitArtist.includes(collabArtist)) {\r\n\t\t\tfoundMatch = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\t});\r\n\r\n\treturn foundMatch;\r\n}\r\n\r\nconst retrieveLyrics = async (id: number, writtenBy: Genius.Artist[]): Promise<string> => {\r\n  const url = `https://genius.com/songs/${id}/embed.js`;\r\n  let lyrics: string;\r\n\r\n  await axios(url)\r\n    .then(res => {\r\n      lyrics = res.data;\r\n    })\r\n    .catch(() => {\r\n\t\t\tlyrics = 'Lyrics unavailble';\r\n\t\t\treturn lyrics;\r\n\t\t});\r\n\r\n\tif (lyrics.length === 0 || lyrics === ' ') {\r\n\t\tlyrics = \"Lyrics unavailable\"\r\n\t\treturn lyrics;\r\n\t}\r\n\r\n\tlyrics = lyrics.replace(new RegExp(`.+?('\\\\)\\\\) {)`), '');\r\n\tlyrics = lyrics.replace(new RegExp(`.+?(type=\"text\\\\/css\" \\\\/>'\\\\))`), '');\r\n\tlyrics = lyrics.replace(new RegExp(`.+?(rg_embed_body\\\\\\\\\\\\\\\\\\\\\\\\\\\">)`), '');\r\n\tlyrics = lyrics.match(new RegExp(`.+?(<\\\\\\\\\\\\/div>)`))[0];\r\n\tlyrics = lyrics.replace(/<[^>]*>/g, '');\r\n\tlyrics = lyrics.replace(/\\\\\\\\n/g, '|n');\r\n\tlyrics = lyrics.replace(/\\\\/g, '');\r\n\tlyrics = lyrics.replace(/\\|n/g, '\\n');\r\n\tlyrics = lyrics.replace(/&amp;/g, '&');\r\n\tlyrics = lyrics.trim();\r\n\r\n\tif (writtenBy.length > 0) {\r\n\t\tlyrics += \"\\n\\nWritten By:\\n\"\r\n\r\n\t\tfor (let writer of writtenBy) {\r\n\t\t\tlyrics += writer.name\r\n\t\t\tif (writer.name !== writtenBy[writtenBy.length-1].name) {\r\n\t\t\t\tlyrics += \", \"\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn lyrics;\r\n}\r\n","module.exports = require(\"axios\");","module.exports = require(\"source-map-support/register\");"],"sourceRoot":""}